{{template "header"}}
    <title>{{.Title}}</title>
{{template "body"}} 
<div id="errorDiv" class="alert" role="alert">

</div>
<script>
    var districts=[]
    var y=document.getElementById('errorDiv')

    fetch('https://localhost:8080/district',{ method:'GET',headers:{'Content-Type':'application/json','Accept':'application/json'},credentials:"include"}).then(
        (result)=>{                    
            if (!result.ok){                    
                throw new Error(JSON.stringify(result.body));
            }
            return result.json();
        }).then((data)=>{
            if(data.hasOwnProperty('Error')){
                y.classList.add("alert-danger")
                y.innerHTML=data['Error']
                form.classList.remove('was-validated')
            }else{
                y.classList.add("alert-success")
                y.innerHTML="Districts data fetched" 
                districts=data.districts  
            }    
        }).catch((e)=>{
            y.classList.add("alert-danger")
            y.innerHTML=e
            form.classList.remove('was-validated')
    })
    
    const observer = new MutationObserver(function(mutationsList) {
    mutationsList.forEach(function(mutation) {
      if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
        setTimeout(()=>{
                    y.className="alert"
                    y.innerHTML=""
                },10000)
      }
    });
    
    observer.observe(y,{attributes:true,childList:true,characterData:true})
  });
   //Initial function called once a page is loaded
   window.onload=function () {
        loadcompleted()             

    }; 

</script>



{{template "footer"}} 